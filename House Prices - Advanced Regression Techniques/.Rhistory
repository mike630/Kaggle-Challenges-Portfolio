all$GarageQual <- as.factor(all$GarageQual)
all$GarageFinish <- as.character(all$GarageFinish)
all$GarageFinish <- ifelse(is.na(all$GarageFinish),'No Garage', all$GarageFinish)
all$GarageFinish <- as.factor(all$GarageFinish)
all$GarageType <- as.character(all$GarageType)
all$GarageType <- ifelse(is.na(all$GarageType),'No Garage', all$GarageType)
all$GarageType <- as.factor(all$GarageType)
all$FireplaceQu <- as.character(all$FireplaceQu)
all$FireplaceQu <- ifelse(is.na(all$FireplaceQu),'No Fireplace', all$FireplaceQu)
all$FireplaceQu <- as.factor(all$FireplaceQu)
all$BsmtFinType2 <- as.character(all$BsmtFinType2)
all$BsmtFinType2 <- ifelse(is.na(all$BsmtFinType2),'No Basement', all$BsmtFinType2)
all$BsmtFinType2 <- as.factor(all$BsmtFinType2)
all$BsmtFinType1 <- as.character(all$BsmtFinType1)
all$BsmtFinType1 <- ifelse(is.na(all$BsmtFinType1),'No Basement', all$BsmtFinType1)
all$BsmtFinType1 <- as.factor(all$BsmtFinType1)
all$BsmtExposure <- as.character(all$BsmtExposure)
all$BsmtExposure <- ifelse(is.na(all$BsmtExposure),'No Basement', all$BsmtExposure)
all$BsmtExposure <- as.factor(all$BsmtExposure)
all$BsmtCond <- as.character(all$BsmtCond)
all$BsmtCond <- ifelse(is.na(all$BsmtCond),'No Basement', all$BsmtCond)
all$BsmtCond <- as.factor(all$BsmtCond)
all$BsmtQual <- as.character(all$BsmtQual)
all$BsmtQual <- ifelse(is.na(all$BsmtQual),'No Basement', all$BsmtQual)
all$BsmtQual <- as.factor(all$BsmtQual)
all$Alley <- as.character(all$Alley)
all$Alley <- ifelse(is.na(all$Alley),'No alley access', all$Alley)
all$Alley <- as.factor(all$Alley)
all$GarageYrBlt <- as.character(all$GarageYrBlt)
all$GarageYrBlt <- ifelse(is.na(all$GarageYrBlt),'No Garage', all$GarageYrBlt)
all$GarageYrBlt <- as.factor(all$GarageYrBlt)
all$GarageCars <- as.character(all$GarageCars)
all$GarageCars <- ifelse(is.na(all$GarageCars), 0 , all$GarageCars)
all$GarageCars <- as.integer(all$GarageCars)
all$GarageArea <- as.character(all$GarageArea)
all$GarageArea <- ifelse(is.na(all$GarageArea), 0 , all$GarageArea)
all$GarageArea <- as.integer(all$GarageArea)
all$MSZoning <- as.character(all$MSZoning)
all$MSZoning <- ifelse(is.na(all$MSZoning) &
all$Street == 'Grvl' &
all$Neighborhood == 'IDOTRR', "C (all)", all$MSZoning)
all$MSZoning <- ifelse(is.na(all$MSZoning) &
all$Street == 'Pave' &
all$Neighborhood == 'IDOTRR', 'RM', all$MSZoning)
all$MSZoning <- ifelse(is.na(all$MSZoning) &
all$Street == 'Pave' &
all$Neighborhood == 'Mitchel', 'RL', all$MSZoning)
all$MSZoning <- as.factor(all$MSZoning)
# Modelagem e Previs
# Prevendo os missing values para o dataset  train
previsao = predict(modelo2, testClean)
previsao
previsao <- as.character(previsao)
all$MasVnrType <- as.character(all$MasVnrType)
all$MasVnrType[is.na(all$MasVnrType)]
class(all$MasVnrType)
all$MasVnrType[is.na(all$MasVnrType)]
all$MasVnrType
previsao
sum(is.na(all$MasVnrType))
(all$MasVnrType)
all$MasVnrType <- as.factor(all$MasVnrType)
all$MasVnrType
all$MasVnrType[is.na(all$MasVnrType)]
#----------------------------------------------------------------------------------------
kable(sapply(all, function(x) sum(is.na(x))))
train <- read.csv(file.choose(), na.strings = c('NA', ''))
kable(sapply(all, function(x) sum(is.na(x))))
train <- read.csv(file.choose(), na.strings = c('NA', ''))
test <- read.csv(file.choose(), na.strings = c('NA', ''))
test$SalePrice <- NA
all <- rbind(train,test)
kable(sapply(all, function(x) sum(is.na(x))))
lues
all$MiscFeature <- as.character(all$MiscFeature)
all$MiscFeature <- ifelse(is.na(all$MiscFeature),'None', all$MiscFeature)
all$MiscFeature <- as.factor(all$MiscFeature)
all$Fence <- as.character(all$Fence)
all$Fence <- ifelse(is.na(all$Fence),'No Fence', all$Fence)
all$Fence <- as.factor(all$Fence)
all$PoolQC <- as.character(all$PoolQC)
all$PoolQC <- ifelse(is.na(all$PoolQC),'No Pool', all$PoolQC)
all$PoolQC <- as.factor(all$PoolQC)
all$GarageCond <- as.character(all$GarageCond)
all$GarageCond <- ifelse(is.na(all$GarageCond),'No Garage', all$GarageCond)
all$GarageCond <- as.factor(all$GarageCond)
all$GarageQual <- as.character(all$GarageQual)
all$GarageQual <- ifelse(is.na(all$GarageQual),'No Garage', all$GarageQual)
all$GarageQual <- as.factor(all$GarageQual)
all$GarageFinish <- as.character(all$GarageFinish)
all$GarageFinish <- ifelse(is.na(all$GarageFinish),'No Garage', all$GarageFinish)
all$GarageFinish <- as.factor(all$GarageFinish)
all$GarageType <- as.character(all$GarageType)
all$GarageType <- ifelse(is.na(all$GarageType),'No Garage', all$GarageType)
all$GarageType <- as.factor(all$GarageType)
all$FireplaceQu <- as.character(all$FireplaceQu)
all$FireplaceQu <- ifelse(is.na(all$FireplaceQu),'No Fireplace', all$FireplaceQu)
all$FireplaceQu <- as.factor(all$FireplaceQu)
all$BsmtFinType2 <- as.character(all$BsmtFinType2)
all$BsmtFinType2 <- ifelse(is.na(all$BsmtFinType2),'No Basement', all$BsmtFinType2)
all$BsmtFinType2 <- as.factor(all$BsmtFinType2)
all$BsmtFinType1 <- as.character(all$BsmtFinType1)
all$BsmtFinType1 <- ifelse(is.na(all$BsmtFinType1),'No Basement', all$BsmtFinType1)
all$BsmtFinType1 <- as.factor(all$BsmtFinType1)
all$BsmtExposure <- as.character(all$BsmtExposure)
all$BsmtExposure <- ifelse(is.na(all$BsmtExposure),'No Basement', all$BsmtExposure)
all$BsmtExposure <- as.factor(all$BsmtExposure)
all$BsmtCond <- as.character(all$BsmtCond)
all$BsmtCond <- ifelse(is.na(all$BsmtCond),'No Basement', all$BsmtCond)
all$BsmtCond <- as.factor(all$BsmtCond)
all$BsmtQual <- as.character(all$BsmtQual)
all$BsmtQual <- ifelse(is.na(all$BsmtQual),'No Basement', all$BsmtQual)
all$BsmtQual <- as.factor(all$BsmtQual)
all$Alley <- as.character(all$Alley)
all$Alley <- ifelse(is.na(all$Alley),'No alley access', all$Alley)
all$Alley <- as.factor(all$Alley)
all$GarageYrBlt <- as.character(all$GarageYrBlt)
all$GarageYrBlt <- ifelse(is.na(all$GarageYrBlt),'No Garage', all$GarageYrBlt)
all$GarageYrBlt <- as.factor(all$GarageYrBlt)
all$GarageCars <- as.character(all$GarageCars)
all$GarageCars <- ifelse(is.na(all$GarageCars), 0 , all$GarageCars)
all$GarageCars <- as.integer(all$GarageCars)
all$GarageArea <- as.character(all$GarageArea)
all$GarageArea <- ifelse(is.na(all$GarageArea), 0 , all$GarageArea)
all$GarageArea <- as.integer(all$GarageArea)
all$MSZoning <- as.character(all$MSZoning)
all$MSZoning <- ifelse(is.na(all$MSZoning) &
all$Street == 'Grvl' &
all$Neighborhood == 'IDOTRR', "C (all)", all$MSZoning)
all$MSZoning <- ifelse(is.na(all$MSZoning) &
all$Street == 'Pave' &
all$Neighborhood == 'IDOTRR', 'RM', all$MSZoning)
all$MSZoning <- ifelse(is.na(all$MSZoning) &
all$Street == 'Pave' &
all$Neighborhood == 'Mitchel', 'RL', all$MSZoning)
all$MSZoning <- as.factor(all$MSZoning)
# Modelagem e Previsao pa
dim(all)[1]
# Modelagem e Previsao para imputar os dados para o MasVnrType no train
amostra = sample(2,dim(all)[1], replace = T, prob = c(0.7,0.3))
trainClean <- all[!is.na(all$MasVnrType) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
testClean <- all[is.na(all$MasVnrType) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
trainClean1 = trainClean[amostra==1,]
trainClean2 = trainClean[amostra==2,]
set.seed(2017)
all$MasVnrType[is.na(all$MasVnrType)]
View(all[is.na(all$MasVnrType)])
View(all[is.na(all$MasVnrType),])
all$MasVnrType[is.na(all$MasVnrType)]
previsao <- as.character(previsao)
all$MasVnrType <- as.character(all$MasVnrType)
all$MasVnrType[is.na(all$MasVnrType)] <- previsao
all$MasVnrType
all$MasVnrType <- as.factor(all$MasVnrType)
all$MasVnrType[is.na(all$MasVnrType)] <- previsao
all$MasVnrType
#----------------------------------------------------------------------------------------
kable(sapply(all, function(x) sum(is.na(x))))
class(all$MasVnrArea)
modelo3 = train(MasVnrArea~MSSubClass+LotArea+LotShape+LotConfig+Neighborhood+
HouseStyle+ OverallQual+OverallCond+YearBuilt+
YearRemodAdd+Exterior1st+Exterior2nd+ExterQual+BsmtQual +BsmtExposure+
BsmtFinType1+X1stFlrSF+X2ndFlrSF,MasVnrType, preProcess = c("center", "scale"),
data = trainClean1, method= 'lm')
modelo3 = train(MasVnrArea~MSSubClass+LotArea+LotShape+LotConfig+Neighborhood+
HouseStyle+ OverallQual+OverallCond+YearBuilt+
YearRemodAdd+Exterior1st+Exterior2nd+ExterQual+BsmtQual +BsmtExposure+
BsmtFinType1+X1stFlrSF+X2ndFlrSF,MasVnrType, preProcess = c("center", "scale"),
data = trainClean1, method= 'lm')
# Modelagem e Previsao para imputar os dados para o MasVnrArea no train
amostra = sample(2,dim(all)[1], replace = T, prob = c(0.7,0.3))
trainClean <- all[!is.na(all$MasVnrArea) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
testClean <- all[is.na(all$MasVnrArea) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
trainClean1 = trainClean[amostra==1,]
trainClean2 = trainClean[amostra==2,]
modelo3 = train(MasVnrArea~MSSubClass+LotArea+LotShape+LotConfig+Neighborhood+
HouseStyle+ OverallQual+OverallCond+YearBuilt+
YearRemodAdd+Exterior1st+Exterior2nd+ExterQual+BsmtQual +BsmtExposure+
BsmtFinType1+X1stFlrSF+X2ndFlrSF,MasVnrType, preProcess = c("center", "scale"),
data = trainClean1, method= 'lm')
#----------------------------------------------------------------------------------------
kable(sapply(trainClean1, function(x) sum(is.na(x))))
# Modelagem e Previsao para imputar os dados para o MasVnrArea no train
amostra = sample(2,dim(all)[1], replace = T, prob = c(0.7,0.3))
trainClean <- all[!is.na(all$MasVnrArea) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
testClean <- all[is.na(all$MasVnrArea) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
trainClean1 = trainClean[amostra==1,]
trainClean2 = trainClean[amostra==2,]
#----------------------------------------------------------------------------------------
kable(sapply(trainClean1, function(x) sum(is.na(x))))
#----------------------------------------------------------------------------------------
kable(sapply(al, function(x) sum(is.na(x))))
#----------------------------------------------------------------------------------------
kable(sapply(all, function(x) sum(is.na(x))))
# Modelagem e Previsao para imputar os dados para o MasVnrArea no train
amostra = sample(2,dim(all)[1], replace = T, prob = c(0.7,0.3))
trainClean <- all[!is.na(all$MasVnrArea) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
trainClean
testClean <- all[is.na(all$MasVnrArea) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
testClean
View(testClean)
trainClean1 = trainClean[amostra==1,]
trainClean2 = trainClean[amostra==2,]
modelo = lm(MasVnrArea~MSSubClass+LotArea+LotShape+LotConfig+Neighborhood+
HouseStyle+ OverallQual+OverallCond+YearBuilt+
YearRemodAdd+Exterior1st+Exterior2nd+ExterQual+BsmtQual +BsmtExposure+
BsmtFinType1+X1stFlrSF+X2ndFlrSF, MasVnrType,
data = trainClean1)
plot(modelo)
summary(modelo$importance)
View(summary(modelo$coefficients))
modelo$coefficients
View(modelo$coefficients)
class(trainClean1$MasVnrArea)
modelo = lm(MasVnrArea~MSSubClass+LotArea+LotShape+LotConfig+Neighborhood+
HouseStyle+ OverallQual+OverallCond+YearBuilt+
YearRemodAdd+Exterior1st+Exterior2nd+ExterQual+BsmtQual +BsmtExposure+
BsmtFinType1+X1stFlrSF+X2ndFlrSF, MasVnrType,
data = trainClean1)
importance(modelo)
modelo$coefficients
str(trainClean1)
View(modelo$coefficients)
summary(modelo)$coefficients
modelo$coefficients
#----------------------------------------------------------------------------------------
kable(sapply(trainClean1, function(x) sum(is.na(x))))
trainClean1 = trainClean[amostra==1,]
trainClean <- all[!is.na(all$MasVnrArea) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
#----------------------------------------------------------------------------------------
kable(sapply(trainClean, function(x) sum(is.na(x))))
all[is.na(all$MasVnrArea)
,]
# Modelagem e Previsao para imputar os dados para o MasVnrArea no train
amostra = sample(2,dim(all)[1], replace = T, prob = c(0.7,0.3))
trainClean <- all[!is.na(all$MasVnrArea) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
testClean <- all[is.na(all$MasVnrArea) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
#----------------------------------------------------------------------------------------
kable(sapply(trainClean, function(x) sum(is.na(x))))
trainClean1 = trainClean[amostra==1,]
trainClean2 = trainClean[amostra==2,]
#----------------------------------------------------------------------------------------
kable(sapply(trainClean1, function(x) sum(is.na(x))))
#----------------------------------------------------------------------------------------
kable(sapply(trainClean1, function(x) sum(is.na(x))))
#----------------------------------------------------------------------------------------
kable(sapply(trainClean2, function(x) sum(is.na(x))))
trainClean <- all[!is.na(all$MasVnrArea) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
#----------------------------------------------------------------------------------------
kable(sapply(trainClean, function(x) sum(is.na(x))))
amostra
trainClean1 = trainClean[amostra==1,]
trainClean1
#----------------------------------------------------------------------------------------
kable(sapply(trainClean1, function(x) sum(is.na(x))))
# Modelagem e Previsao para imputar os dados para o MasVnrType no train
amostra = sample(2,dim(all)[1], replace = T, prob = c(0.7,0.3))
trainClean <- all[!is.na(all$MasVnrType) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
testClean <- all[is.na(all$MasVnrType) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
trainClean1 = trainClean[amostra==1,]
trainClean2 = trainClean[amostra==2,]
#----------------------------------------------------------------------------------------
kable(sapply(trainClean1, function(x) sum(is.na(x))))
# Modelagem e Previsao para imputar os dados para o MasVnrArea no train
amostra = sample(2,dim(all)[1], replace = T, prob = c(0.7,0.3))
trainClean <- all[!is.na(all$MasVnrArea) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
trainClean1 = trainClean[amostra==1,]
#----------------------------------------------------------------------------------------
kable(sapply(trainClean1, function(x) sum(is.na(x))))
trainClean <- all[!is.na(all$MasVnrArea),]
trainClean1 = trainClean[amostra==1,]
# Modelagem e Previsao para imputar os dados para o MasVnrArea no train
amostra = sample(2,dim(all)[1], replace = T, prob = c(0.7,0.3))
trainClean <- all[!is.na(all$MasVnrArea),]
trainClean1 = trainClean[amostra==1,]
#----------------------------------------------------------------------------------------
kable(sapply(trainClean1, function(x) sum(is.na(x))))
!is.na(all$MasVnrArea)
View(all[!is.na(all$MasVnrArea),])
#----------------------------------------------------------------------------------------
kable(sapply(all, function(x) sum(is.na(x))))
View(all[is.na(all$MasVnrArea),])
trainClean1 = trainClean[amostra==1,]
#----------------------------------------------------------------------------------------
kable(sapply(trainClean1, function(x) sum(is.na(x))))
#----------------------------------------------------------------------------------------
kable(sapply(testClean, function(x) sum(is.na(x))))
testClean <- all[is.na(all$MasVnrArea) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
#----------------------------------------------------------------------------------------
kable(sapply(testClean, function(x) sum(is.na(x))))
modelo = lm(MasVnrArea~MSSubClass+LotArea+LotShape+LotConfig+Neighborhood+
HouseStyle+ OverallQual+OverallCond+YearBuilt+
YearRemodAdd+Exterior1st+Exterior2nd+ExterQual+BsmtQual +BsmtExposure+
BsmtFinType1+X1stFlrSF+X2ndFlrSF, MasVnrType, data = trainClean)
View(modelo$coefficients)
#----------------------------------------------------------------------------------------
kable(sapply(trainClean, function(x) sum(is.na(x))))
modelo3 = train(MasVnrArea~MSSubClass+LotArea+LotShape+LotConfig+Neighborhood+
HouseStyle+ OverallQual+OverallCond+YearBuilt+
YearRemodAdd+Exterior1st+Exterior2nd+ExterQual+BsmtQual +BsmtExposure+
BsmtFinType1+X1stFlrSF+X2ndFlrSF,MasVnrType,
data = trainClean1, method= 'lm')
modelo = lm(MasVnrArea~MSSubClass+LotArea+LotShape+LotConfig+Neighborhood+
HouseStyle+ OverallQual+OverallCond+YearBuilt+
YearRemodAdd+Exterior1st+Exterior2nd+ExterQual+BsmtQual +BsmtExposure+
BsmtFinType1+X1stFlrSF+X2ndFlrSF, MasVnrType, data = trainClean)
summary(modelo)$coefficients
modelo$coefficients
set.seed(2017)
modelo = lm(MasVnrArea~MSSubClass+LotArea+LotShape+LotConfig+Neighborhood+
HouseStyle+ OverallQual+OverallCond+YearBuilt+
YearRemodAdd+Exterior1st+Exterior2nd+ExterQual+BsmtQual +BsmtExposure+
BsmtFinType1+X1stFlrSF+X2ndFlrSF, MasVnrType, data = trainClean)
modelo$coefficients
trainClean1 = trainClean[amostra==1,]
#----------------------------------------------------------------------------------------
kable(sapply(trainClean1, function(x) sum(is.na(x))))
train <- read.csv(file.choose(), na.strings = c('NA', ''))
test <- read.csv(file.choose(), na.strings = c('NA', ''))
colnames(train[!colnames(train) %in% colnames(test)])
test$SalePrice <- NA
all <- rbind(train,test)
values
all$MiscFeature <- as.character(all$MiscFeature)
all$MiscFeature <- ifelse(is.na(all$MiscFeature),'None', all$MiscFeature)
all$MiscFeature <- as.factor(all$MiscFeature)
all$Fence <- as.character(all$Fence)
all$Fence <- ifelse(is.na(all$Fence),'No Fence', all$Fence)
all$Fence <- as.factor(all$Fence)
all$PoolQC <- as.character(all$PoolQC)
all$PoolQC <- ifelse(is.na(all$PoolQC),'No Pool', all$PoolQC)
all$PoolQC <- as.factor(all$PoolQC)
all$GarageCond <- as.character(all$GarageCond)
all$GarageCond <- ifelse(is.na(all$GarageCond),'No Garage', all$GarageCond)
all$GarageCond <- as.factor(all$GarageCond)
all$GarageQual <- as.character(all$GarageQual)
all$GarageQual <- ifelse(is.na(all$GarageQual),'No Garage', all$GarageQual)
all$GarageQual <- as.factor(all$GarageQual)
all$GarageFinish <- as.character(all$GarageFinish)
all$GarageFinish <- ifelse(is.na(all$GarageFinish),'No Garage', all$GarageFinish)
all$GarageFinish <- as.factor(all$GarageFinish)
all$GarageType <- as.character(all$GarageType)
all$GarageType <- ifelse(is.na(all$GarageType),'No Garage', all$GarageType)
all$GarageType <- as.factor(all$GarageType)
all$FireplaceQu <- as.character(all$FireplaceQu)
all$FireplaceQu <- ifelse(is.na(all$FireplaceQu),'No Fireplace', all$FireplaceQu)
all$FireplaceQu <- as.factor(all$FireplaceQu)
all$BsmtFinType2 <- as.character(all$BsmtFinType2)
all$BsmtFinType2 <- ifelse(is.na(all$BsmtFinType2),'No Basement', all$BsmtFinType2)
all$BsmtFinType2 <- as.factor(all$BsmtFinType2)
all$BsmtFinType1 <- as.character(all$BsmtFinType1)
all$BsmtFinType1 <- ifelse(is.na(all$BsmtFinType1),'No Basement', all$BsmtFinType1)
all$BsmtFinType1 <- as.factor(all$BsmtFinType1)
all$BsmtExposure <- as.character(all$BsmtExposure)
all$BsmtExposure <- ifelse(is.na(all$BsmtExposure),'No Basement', all$BsmtExposure)
all$BsmtExposure <- as.factor(all$BsmtExposure)
all$BsmtCond <- as.character(all$BsmtCond)
all$BsmtCond <- ifelse(is.na(all$BsmtCond),'No Basement', all$BsmtCond)
all$BsmtCond <- as.factor(all$BsmtCond)
all$BsmtQual <- as.character(all$BsmtQual)
all$BsmtQual <- ifelse(is.na(all$BsmtQual),'No Basement', all$BsmtQual)
all$BsmtQual <- as.factor(all$BsmtQual)
all$Alley <- as.character(all$Alley)
all$Alley <- ifelse(is.na(all$Alley),'No alley access', all$Alley)
all$Alley <- as.factor(all$Alley)
all$GarageYrBlt <- as.character(all$GarageYrBlt)
all$GarageYrBlt <- ifelse(is.na(all$GarageYrBlt),'No Garage', all$GarageYrBlt)
all$GarageYrBlt <- as.factor(all$GarageYrBlt)
all$GarageCars <- as.character(all$GarageCars)
all$GarageCars <- ifelse(is.na(all$GarageCars), 0 , all$GarageCars)
all$GarageCars <- as.integer(all$GarageCars)
all$GarageArea <- as.character(all$GarageArea)
all$GarageArea <- ifelse(is.na(all$GarageArea), 0 , all$GarageArea)
all$GarageArea <- as.integer(all$GarageArea)
all$MSZoning <- as.character(all$MSZoning)
all$MSZoning <- ifelse(is.na(all$MSZoning) &
all$Street == 'Grvl' &
all$Neighborhood == 'IDOTRR', "C (all)", all$MSZoning)
all$MSZoning <- ifelse(is.na(all$MSZoning) &
all$Street == 'Pave' &
all$Neighborhood == 'IDOTRR', 'RM', all$MSZoning)
all$MSZoning <- ifelse(is.na(all$MSZoning) &
all$Street == 'Pave' &
all$Neighborhood == 'Mitchel', 'RL', all$MSZoning)
all$MSZoning <- as.factor(all$MSZoning)
# Modelagem e Previsao
# Modelagem e Previsao para imputar os dados para o MasVnrArea no train
amostra = sample(2,dim(all)[1], replace = T, prob = c(0.7,0.3))
trainClean <- all[!is.na(all$MasVnrArea) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
testClean <- all[is.na(all$MasVnrArea) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
trainClean1 = trainClean[amostra==1,]
trainClean2 = trainClean[amostra==2,]
#----------------------------------------------------------------------------------------
kable(sapply(trainClean1, function(x) sum(is.na(x))))
trainClean1[trainClean1$MasVnrArea==0,]
View(trainClean)
modelo = lm(MasVnrArea~MSSubClass+LotArea+LotShape+LotConfig+Neighborhood+
HouseStyle+ OverallQual+OverallCond+YearBuilt+
YearRemodAdd+Exterior1st+Exterior2nd+ExterQual+BsmtQual +BsmtExposure+
BsmtFinType1+X1stFlrSF+X2ndFlrSF, MasVnrType, data = trainClean)
modelo$coefficients
summary(modelo)$coefficients
levels(all$LotShape)
trainClean1 = trainClean[amostra==1,]
#----------------------------------------------------------------------------------------
kable(sapply(trainClean1, function(x) sum(is.na(x))))
#----------------------------------------------------------------------------------------
kable(sapply(trainClean1, function(x) sum(is.na(x))))
write.csv(all, file = 'all.csv', row.names = F )
trainClean[amostra==1,]
trainClean1 <- trainClean[amostra==1,]
#----------------------------------------------------------------------------------------
kable(sapply(trainClean1, function(x) sum(is.na(x))))
# Modelagem e Previsao para imputar os dados para o MasVnrType no train
amostra = sample(2,dim(all)[1], replace = T, prob = c(0.7,0.3))
trainClean <- all[!is.na(all$MasVnrType) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
testClean <- all[is.na(all$MasVnrType) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
trainClean1 = trainClean[amostra==1,]
trainClean2 = trainClean[amostra==2,]
#----------------------------------------------------------------------------------------
kable(sapply(trainClean1, function(x) sum(is.na(x))))
# Modelagem e Previsao para imputar os dados para o MasVnrType no train
amostra = sample(2,dim(all)[1], replace = T, prob = c(0.7,0.3))
trainClean <- all[!is.na(all$MasVnrType) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
testClean <- all[is.na(all$MasVnrType) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
trainClean1 = trainClean[amostra==1,]
trainClean2 = trainClean[amostra==2,]
#----------------------------------------------------------------------------------------
kable(sapply(trainClean1, function(x) sum(is.na(x))))
train <- read.csv(file.choose(), na.strings = c('NA', ''))
test <- read.csv(file.choose(), na.strings = c('NA', ''))
colnames(train[!colnames(train) %in% colnames(test)])
test$SalePrice <- NA
all <- rbind(train,test)
ues
all$MiscFeature <- as.character(all$MiscFeature)
all$MiscFeature <- ifelse(is.na(all$MiscFeature),'None', all$MiscFeature)
all$MiscFeature <- as.factor(all$MiscFeature)
all$Fence <- as.character(all$Fence)
all$Fence <- ifelse(is.na(all$Fence),'No Fence', all$Fence)
all$Fence <- as.factor(all$Fence)
all$PoolQC <- as.character(all$PoolQC)
all$PoolQC <- ifelse(is.na(all$PoolQC),'No Pool', all$PoolQC)
all$PoolQC <- as.factor(all$PoolQC)
all$GarageCond <- as.character(all$GarageCond)
all$GarageCond <- ifelse(is.na(all$GarageCond),'No Garage', all$GarageCond)
all$GarageCond <- as.factor(all$GarageCond)
all$GarageQual <- as.character(all$GarageQual)
all$GarageQual <- ifelse(is.na(all$GarageQual),'No Garage', all$GarageQual)
all$GarageQual <- as.factor(all$GarageQual)
all$GarageFinish <- as.character(all$GarageFinish)
all$GarageFinish <- ifelse(is.na(all$GarageFinish),'No Garage', all$GarageFinish)
all$GarageFinish <- as.factor(all$GarageFinish)
all$GarageType <- as.character(all$GarageType)
all$GarageType <- ifelse(is.na(all$GarageType),'No Garage', all$GarageType)
all$GarageType <- as.factor(all$GarageType)
all$FireplaceQu <- as.character(all$FireplaceQu)
all$FireplaceQu <- ifelse(is.na(all$FireplaceQu),'No Fireplace', all$FireplaceQu)
all$FireplaceQu <- as.factor(all$FireplaceQu)
all$BsmtFinType2 <- as.character(all$BsmtFinType2)
all$BsmtFinType2 <- ifelse(is.na(all$BsmtFinType2),'No Basement', all$BsmtFinType2)
all$BsmtFinType2 <- as.factor(all$BsmtFinType2)
all$BsmtFinType1 <- as.character(all$BsmtFinType1)
all$BsmtFinType1 <- ifelse(is.na(all$BsmtFinType1),'No Basement', all$BsmtFinType1)
all$BsmtFinType1 <- as.factor(all$BsmtFinType1)
all$BsmtExposure <- as.character(all$BsmtExposure)
all$BsmtExposure <- ifelse(is.na(all$BsmtExposure),'No Basement', all$BsmtExposure)
all$BsmtExposure <- as.factor(all$BsmtExposure)
all$BsmtCond <- as.character(all$BsmtCond)
all$BsmtCond <- ifelse(is.na(all$BsmtCond),'No Basement', all$BsmtCond)
all$BsmtCond <- as.factor(all$BsmtCond)
all$BsmtQual <- as.character(all$BsmtQual)
all$BsmtQual <- ifelse(is.na(all$BsmtQual),'No Basement', all$BsmtQual)
all$BsmtQual <- as.factor(all$BsmtQual)
all$Alley <- as.character(all$Alley)
all$Alley <- ifelse(is.na(all$Alley),'No alley access', all$Alley)
all$Alley <- as.factor(all$Alley)
all$GarageYrBlt <- as.character(all$GarageYrBlt)
all$GarageYrBlt <- ifelse(is.na(all$GarageYrBlt),'No Garage', all$GarageYrBlt)
all$GarageYrBlt <- as.factor(all$GarageYrBlt)
all$GarageCars <- as.character(all$GarageCars)
all$GarageCars <- ifelse(is.na(all$GarageCars), 0 , all$GarageCars)
all$GarageCars <- as.integer(all$GarageCars)
all$GarageArea <- as.character(all$GarageArea)
all$GarageArea <- ifelse(is.na(all$GarageArea), 0 , all$GarageArea)
all$GarageArea <- as.integer(all$GarageArea)
all$MSZoning <- as.character(all$MSZoning)
all$MSZoning <- ifelse(is.na(all$MSZoning) &
all$Street == 'Grvl' &
all$Neighborhood == 'IDOTRR', "C (all)", all$MSZoning)
all$MSZoning <- ifelse(is.na(all$MSZoning) &
all$Street == 'Pave' &
all$Neighborhood == 'IDOTRR', 'RM', all$MSZoning)
all$MSZoning <- ifelse(is.na(all$MSZoning) &
all$Street == 'Pave' &
all$Neighborhood == 'Mitchel', 'RL', all$MSZoning)
all$MSZoning <- as.factor(all$MSZoning)
# Modelagem e Previsao par
# Modelagem e Previsao para imputar os dados para o MasVnrType no train
amostra = sample(2,dim(all)[1], replace = T, prob = c(0.7,0.3))
trainClean <- all[!is.na(all$MasVnrType) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
testClean <- all[is.na(all$MasVnrType) & !is.na(all$Exterior1st) & !is.na(all$Exterior2nd),]
trainClean1 = trainClean[amostra==1,]
trainClean2 = trainClean[amostra==2,]
#----------------------------------------------------------------------------------------
kable(sapply(trainClean1, function(x) sum(is.na(x))))
set.seed(2017)
modelo = randomForest(MasVnrType~MSSubClass+LotArea+LotShape+LotConfig+Neighborhood+
HouseStyle+ OverallQual+OverallCond+YearBuilt+
YearRemodAdd+Exterior1st+Exterior2nd+ExterQual+BsmtQual +BsmtExposure+
BsmtFinType1+X1stFlrSF+X2ndFlrSF,
data = trainClean1, ntree= 350)
